# Default values for bmgAgentgateway.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Namespace for deployment (defaults to agentgateway-system)
namespace: "agentgateway-system"

# Azure Configuration (shared)
azure:
  clientId: "11ddc0cd-e6fc-48b6-8832-de61800fb41e"
  tenantId: "6ba231bb-ad9e-41b9-b23d-674c80196bbd"

# BMG Agent Configuration
bmgAgent:
  configMap:
    name: "bmg-agent-config"
    agentMode: "api"
    agentPort: "8070"
    agentHost: "0.0.0.0"
    mcpServersJson: '[{"url":"http://{{ .Values.gateway.name }}.{{ .Values.namespace }}.svc.cluster.local:{{ .Values.gateway.listeners[0].port }}/mcp/mcp-mssql"}]'
  deployment:
    name: "bmg-agent-deployment"
    replicas: 1
    image:
      repository: "sawnjordan/multi-agent"
      tag: "v0.8"
      pullPolicy: "IfNotPresent"
    ports:
      - containerPort: 8000
      - containerPort: 8070
  service:
    name: "bmg-agent-service"
    type: "ClusterIP"
    port: 8070
    targetPort: 8070
  secret:
    name: "bmg-agent-secrets"
    deepseekApiKey: ""

# BMG UI Configuration
bmgUi:
  deployment:
    name: "bmg-ui"
    replicas: 1
    image:
      repository: "kamalberrybytes/adk-web-ui"
      tag: "v5"
      pullPolicy: "Always"
    port: 5000
    env:
      azureClientSecret: ""
      redirectUri: "http://localhost:5000/auth/callback"
      secretKey: "helloworld"
      azureScopes: "openid api://{{ .Values.azure.clientId }}/mcp.access"
      gatewayUrl: "http://{{ .Values.gateway.name }}.{{ .Values.namespace }}.svc.cluster.local:{{ .Values.gateway.listeners[0].port }}"
      bmgApi: "http://{{ .Values.bmgAgent.service.name }}.{{ .Values.namespace }}.svc.cluster.local:{{ .Values.bmgAgent.service.port }}"
  service:
    name: "bmg-ui-service"
    port: 5000
    targetPort: 5000
  httpRoute:
    name: "bmg-ui"
    rules:
      - matches:
          - path:
              type: PathPrefix
              value: /ui
        filters:
          - type: URLRewrite
            urlRewrite:
              path:
                type: ReplacePrefixMatch
                replacePrefixMatch: /
      - matches:
          - path:
              type: PathPrefix
              value: /auth

# MCP Hubspot Configuration
mcpHubspot:
  backend:
    name: "mcp-hubspot-backend"
    targetName: "mcp-hubspot-target"
    host: "{{ .Values.mcpHubspot.service.name }}.{{ .Values.namespace }}.svc.cluster.local"
    protocol: "StreamableHTTP"
  deployment:
    name: "mcp-hubspot"
    image:
      repository: "kamalberrybytes/mcp-hubspot"
      tag: "latest"
      pullPolicy: "Always"
  service:
    name: "mcp-hubspot-service"
    port: 8000
    targetPort: 8000
    appProtocol: "kgateway.dev/mcp"
  httpRoute:
    name: "mcp-hubspot"

# MCP MSSQL Configuration
mcpMssql:
  backend:
    name: "mcp-mssql-backend"
    targetName: "mcp-mssql-target"
    host: "{{ .Values.mcpMssql.service.name }}.{{ .Values.namespace }}.svc.cluster.local"
    protocol: "StreamableHTTP"
  deployment:
    name: "mcp-mssql"
    image:
      repository: "kamalberrybytes/mssql-mcp"
      tag: "v1"
      pullPolicy: "Always"
    env:
      mssqlServer: "my-mssqlserver-2022"
      mssqlDatabase: "msdb"
      mssqlPort: "1433"
      mssqlUser: "sa"
      mssqlPassword: ""
  service:
    name: "mcp-mssql-service"
    port: 8000
    targetPort: 8000
    appProtocol: "kgateway.dev/mcp"
  httpRoute:
    name: "mcp-mssql"

# Gateway Configuration
gateway:
  name: "agentgateway-proxy"
  gatewayClassName: "agentgateway"
  listeners:
    - protocol: "HTTP"
      port: 8080
      name: "http"
      allowedRoutes:
        namespaces:
          from: "All"

# Policy Configuration
policy:
  name: "azure-mcp-authn-policy"
  targetRefs:
    - group: "gateway.networking.k8s.io"
      kind: "Gateway"
  jwtAuthentication:
    mode: "Strict"
    providers:
      - cacheDuration: "5m"
        backendRef:
          group: ""
          kind: "Service"
          name: "azure-ad-jwks"
          port: 443
  jwksService:
    name: "azure-ad-jwks"
    externalName: "login.microsoftonline.com"

# Default values (keeping original for compatibility)
# This will set the replicaset count more information can be found here: https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/
replicaCount: 1

# This sets the container image more information can be found here: https://kubernetes.io/docs/concepts/containers/images/
image:
  repository: nginx
  # This sets the pull policy for images.
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

# This is for the secrets for pulling an image from a private repository more information can be found here: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/
imagePullSecrets: []
# This is to override the chart name.
nameOverride: ""
fullnameOverride: ""

# This section builds out the service account more information can be found here: https://kubernetes.io/docs/concepts/security/service-accounts/
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Automatically mount a ServiceAccount's API credentials?
  automount: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# This is for setting Kubernetes Annotations to a Pod.
# For more information checkout: https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/
podAnnotations: {}
# This is for setting Kubernetes Labels to a Pod.
# For more information checkout: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/
podLabels: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

# This is for setting up a service more information can be found here: https://kubernetes.io/docs/concepts/services-networking/service/
service:
  # This sets the service type more information can be found here: https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types
  type: ClusterIP
  # This sets the ports more information can be found here: https://kubernetes.io/docs/concepts/services-networking/service/#field-spec-ports
  port: 80

# This block is for setting up the ingress for more information can be found here: https://kubernetes.io/docs/concepts/services-networking/ingress/
ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

# -- Expose the service via gateway-api HTTPRoute
# Requires Gateway API resources and suitable controller installed within the cluster
# (see: https://gateway-api.sigs.k8s.io/guides/)
httpRoute:
  # HTTPRoute enabled.
  enabled: false
  # HTTPRoute annotations.
  annotations: {}
  # Which Gateways this Route is attached to.
  parentRefs:
  - name: gateway
    sectionName: http
    # namespace: default
  # Hostnames matching HTTP header.
  hostnames:
  - chart-example.local
  # List of rules and filters applied.
  rules:
  - matches:
    - path:
        type: PathPrefix
        value: /headers
  #   filters:
  #   - type: RequestHeaderModifier
  #     requestHeaderModifier:
  #       set:
  #       - name: My-Overwrite-Header
  #         value: this-is-the-only-value
  #       remove:
  #       - User-Agent
  # - matches:
  #   - path:
  #       type: PathPrefix
  #       value: /echo
  #     headers:
  #     - name: version
  #       value: v2

resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

# This is to setup the liveness and readiness probes more information can be found here: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/
livenessProbe:
  httpGet:
    path: /
    port: http
readinessProbe:
  httpGet:
    path: /
    port: http

# This section is for setting up autoscaling more information can be found here: https://kubernetes.io/docs/concepts/workloads/autoscaling/
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

# Additional volumes on the output Deployment definition.
volumes: []
# - name: foo
#   secret:
#     secretName: mysecret
#     optional: false

# Additional volumeMounts on the output Deployment definition.
volumeMounts: []
# - name: foo
#   mountPath: "/etc/foo"
#   readOnly: true

nodeSelector: {}

tolerations: []

affinity: {}
