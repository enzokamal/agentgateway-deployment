# Default values for bmgAgentgateway.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Namespace for deployment (defaults to default)
namespace: "production"

# Azure Configuration (shared) - REQUIRED
azure:
  clientId: "11ddc0cd-e6fc-48b6-8832-de61800fb41e"  
  tenantId: "6ba231bb-ad9e-41b9-b23d-674c80196bbd"  

# Agent Configuration
agent:
  configMap:
    name: "agent-config"
    agentMode: "api"  
    agentPort: "8070" 
    agentHost: "0.0.0.0"  
    mcpServersJson: '[{"url":"http://agentgateway-proxy.{{ .Values.namespace }}.svc.cluster.local:8080/mcp/mcp-mssql"}]'
  deployment:
    name: "agent-deployment"
    replicas: 1
    image:
      repository: "sawnjordan/multi-agent"
      tag: "v0.8"  
      pullPolicy: "IfNotPresent"
    ports:
      - containerPort: 8000
      - containerPort: 8070
  service:
    name: "agent-service"
    type: "ClusterIP"
    port: 8070
    targetPort: 8070
  secret:
    name: "agent-secrets"
    deepseekApiKey: ""  

# UI Configuration
ui:
  deployment:
    name: "ui"
    replicas: 1
    image:
      repository: "kamalberrybytes/adk-web-ui"
      tag: "v5"
      pullPolicy: "Always"
    port: 5000
    env:
      redirectUri: "http://localhost:5000/auth/callback"  # REQUIRED: OAuth Redirect URI
      azureScopes: "openid api://11ddc0cd-e6fc-48b6-8832-de61800fb41e/mcp.access"  # REQUIRED: Azure Scopes
      gatewayUrl: "http://agentgateway-proxy.{{ .Values.namespace }}.svc.cluster.local:8080"
      adkApi: "http://agent-service.{{ .Values.namespace }}.svc.cluster.local:8070"
  secret:
    name: "ui-secrets"
    azureClientSecret: ""  # REQUIRED: Azure Client Secret
    secretKey: "hello world"  # REQUIRED: Flask Secret Key
  service:
    name: "ui-service"
    port: 5000
    targetPort: 5000
  httpRoute:
    name: "ui"

# MCP HubSpot Configuration
mcpHubspot:
  backend:
    name: "mcp-hubspot-backend"
    targetName: "mcp-hubspot-target"
    host: "mcp-hubspot-service.{{ .Values.namespace }}.svc.cluster.local"
    protocol: "StreamableHTTP"
  deployment:
    name: "mcp-hubspot"
    replicas: 1
    image:
      repository: "kamalberrybytes/mcp-hubspot"
      tag: "latest"
      pullPolicy: "Always"
  service:
    name: "mcp-hubspot-service"
    port: 8000
    targetPort: 8000
    appProtocol: "kgateway.dev/mcp"
  httpRoute:
    name: "mcp-hubspot"

# MCP MSSQL Configuration
mcpMssql:
  backend:
    name: "mcp-mssql-backend"
    targetName: "mcp-mssql-target"
    host: "mcp-mssql-service.{{ .Values.namespace }}.svc.cluster.local"
    protocol: "StreamableHTTP"
  deployment:
    name: "mcp-mssql"
    replicas: 1
    image:
      repository: "kamalberrybytes/mssql-mcp"
      tag: "v1"
      pullPolicy: "Always"
    env:
      # All MSSQL values are REQUIRED
      mssqlServer: "my-mssqlserver-2022"  
      mssqlDatabase: "msdb"  
      mssqlPort: "1433"  
      mssqlUser: "sa"  
      mssqlPassword: "kjfkldja;flk"  
  service:
    name: "mcp-mssql-service"
    port: 8000
    targetPort: 8000
    appProtocol: "kgateway.dev/mcp"
  httpRoute:
    name: "mcp-mssql"

# Gateway Configuration
gateway:
  name: "agentgateway-proxy"
  gatewayClassName: "agentgateway"
  listeners:
    - protocol: "HTTP"
      port: 8080
      name: "http"
      allowedRoutes:
        namespaces:
          from: "All"

# Policy Configuration
policy:
  name: "azure-mcp-authn-policy"
  targetRefs:
    - group: "gateway.networking.k8s.io"
      kind: "Gateway"
  jwtAuthentication:
    mode: "Strict"
    providers:
      - cacheDuration: "5m"
        backendRef:
          group: ""
          kind: "Service"
          name: "azure-ad-jwks"
          port: 443
  jwksService:
    name: "azure-ad-jwks"
    externalName: "login.microsoftonline.com"